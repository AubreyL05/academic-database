{% extends "base.html" %}

{% block title %}Academic Reports Dashboard{% endblock %}

{% block content %}
<h2 class="report-title" style="text-align:center; border-bottom:none;">Academic Reports Dashboard</h2>
<p style="text-align: center; margin-bottom: 30px; color: #6b7280;">Insights generated from complex SQL queries.</p>

<!-- Report 1: Department Summary Statistics -->
<h3 class="report-title">Department Summary Statistics</h3>
<div style="max-width: 800px; margin: auto;">
    <table class="styled-table">
        <thead>
            <tr>
                <th>Department Name</th>
                <th>Instructors</th>
                <th>Courses Offered</th>
            </tr>
        </thead>
        <tbody>
            {% for dept in department_stats %}
            <tr>
                <td>{{ dept.department_name }}</td>
                <td>{{ dept.num_instructors }}</td>
                <td>{{ dept.num_courses }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="3" style="text-align: center;">No department statistics found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Report 2: Top 10 Heavily Enrolled Sections -->
<h3 class="report-title">Top 10 Heavily Enrolled Sections</h3>
<div style="max-width: 800px; margin: auto;">
    <table class="styled-table">
        <thead>
            <tr>
                <th>Course Code</th>
                <th>Course Name</th>
                <th>Section Code</th>
                <th>Enrollments</th>
            </tr>
        </thead>
        <tbody>
            {% for section in busiest_sections %}
            <tr>
                <td>{{ section.course_code }}</td>
                <td>{{ section.course_name }}</td>
                <td>{{ section.section_code }}</td>
                <td>{{ section.enrollment_count }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="4" style="text-align: center;">No enrollment data for reports found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Report 3: Search Students by Major -->
<h3 class="report-title">Search Students by Major</h3>
<div class="form-container">
    <form method="POST" action="/reports" class="form-box">
        <label for="major">Choose a major:</label>
        <select name="major" id="major">
            <option value="Bioengineering">Bioengineering</option>
            <option value="Chemical Engineering">Chemical Engineering</option>
            <option value="Computer Science & Engineering">Computer Science & Engineering</option>
            <option value="Electrical & Computer Engineering">Electrical & Computer Engineering</option>
            <option value="Mechanical Engineering">Mechanical Engineering</option>
        </select>
        <br><br>
        <button type="submit">Search</button>
    </form>
</div>

{% if student_major %}
<p style="margin-top: 20px; margin-bottom: 10px; font-weight: bold; text-align: center;">
    Students in {{ selected_major }}
</p>
<div class="scrollable-table" style="max-width: 600px; margin: 0 auto;">
    <table class="styled-table">
        <thead>
            <tr>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Email</th>
            </tr>
        </thead>
        <tbody>
            {% for student in student_major %}
            <tr>
                <td>{{ student[0] }}</td>
                <td>{{ student[1] }}</td>
                <td>{{ student[2] }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="3" style="text-align: center;">No students found for this major.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

<!-- Report 4: Top 10 Students by GPA -->
<h3 class="report-title">Top 10 Students by GPA</h3>
<div style="max-width: 700px; margin: auto;">
    <table class="styled-table">
        <thead>
            <tr>
                <th>Student ID</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Major</th>
                <th>GPA</th>
            </tr>
        </thead>
        <tbody>
            {% for student in top_gpa_students %}
            <tr>
                <td>{{ student.id }}</td>
                <td>{{ student.first_name }}</td>
                <td>{{ student.last_name }}</td>
                <td>{{ student.major }}</td>
                <td>{{ student.gpa }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="5" style="text-align: center;">No student GPA data found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}